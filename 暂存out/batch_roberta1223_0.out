Loaded train features
Loaded dev features
Loaded test features
/root/miniconda3/lib/python3.8/site-packages/transformers/optimization.py:591: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
/root/miniconda3/lib/python3.8/site-packages/apex-0.1-py3.8.egg/apex/__init__.py:68: DeprecatedFeatureWarning: apex.amp is deprecated and will be removed by the end of February 2023. Use [PyTorch AMP](https://pytorch.org/docs/stable/amp.html)
  warnings.warn(msg, DeprecatedFeatureWarning)
Total steps: 22920
Warmup steps: 1375
/root/miniconda3/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:129: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.44it/s]
{'dev_F1': 50.47337474670298, 'dev_F1_ign': 47.62176076538619, 'dev_P': 42.61274399820507, 'dev_R': 61.890020366598776}
Current Step: 763,  Current LM lr: 1.66473e-05, Current Classifier lr: 5.54909e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.48it/s]
{'dev_F1': 52.258188086573455, 'dev_F1_ign': 49.777118214310356, 'dev_P': 49.32031814895155, 'dev_R': 55.568228105906314}
Current Step: 1527,  Current LM lr: 2.97883e-05, Current Classifier lr: 9.92945e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.41it/s]
{'dev_F1': 51.72099456197152, 'dev_F1_ign': 48.51618903624833, 'dev_P': 42.107687583171256, 'dev_R': 67.0224032586558}
Current Step: 2291,  Current LM lr: 2.87245e-05, Current Classifier lr: 9.57484e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.19it/s]
{'dev_F1': 56.767543689696595, 'dev_F1_ign': 54.12259126312223, 'dev_P': 54.13094886195684, 'dev_R': 59.67413441955194}
Current Step: 3055,  Current LM lr: 2.76607e-05, Current Classifier lr: 9.22024e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.43it/s]
{'dev_F1': 57.2913031677717, 'dev_F1_ign': 54.82761114894793, 'dev_P': 54.66114234980763, 'dev_R': 60.187372708757636}
Current Step: 3819,  Current LM lr: 2.65969e-05, Current Classifier lr: 8.86563e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.27it/s]
{'dev_F1': 58.26140567200987, 'dev_F1_ign': 55.811236358832915, 'dev_P': 55.27527966659355, 'dev_R': 61.58859470468432}
Current Step: 4583,  Current LM lr: 2.55331e-05, Current Classifier lr: 8.51102e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 17.89it/s]
{'dev_F1': 58.27244742795682, 'dev_F1_ign': 55.67873134731928, 'dev_P': 53.48583877995643, 'dev_R': 64.0}
Current Step: 5347,  Current LM lr: 2.44693e-05, Current Classifier lr: 8.15642e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:29<00:00, 17.09it/s]
{'dev_F1': 58.558354133575364, 'dev_F1_ign': 56.20731780560815, 'dev_P': 54.648125926448785, 'dev_R': 63.07128309572302}
Current Step: 6111,  Current LM lr: 2.34054e-05, Current Classifier lr: 7.80181e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:28<00:00, 17.48it/s]
{'dev_F1': 59.80902777777778, 'dev_F1_ign': 57.155843570430534, 'dev_P': 53.78260586742991, 'dev_R': 67.35641547861508}
Current Step: 6875,  Current LM lr: 2.23416e-05, Current Classifier lr: 7.44720e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:28<00:00, 17.65it/s]
{'dev_F1': 60.00568851326642, 'dev_F1_ign': 57.83249002595172, 'dev_P': 59.85732814526589, 'dev_R': 60.15478615071284}
Current Step: 7639,  Current LM lr: 2.12778e-05, Current Classifier lr: 7.09260e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:28<00:00, 17.37it/s]
{'dev_F1': 60.31985895982873, 'dev_F1_ign': 58.251092272491356, 'dev_P': 62.218565985452024, 'dev_R': 58.53360488798371}
Current Step: 8403,  Current LM lr: 2.02140e-05, Current Classifier lr: 6.73799e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:28<00:00, 17.50it/s]
{'dev_F1': 59.83753480035088, 'dev_F1_ign': 57.40184448158659, 'dev_P': 56.25268894306611, 'dev_R': 63.91038696537679}
Current Step: 9167,  Current LM lr: 1.91502e-05, Current Classifier lr: 6.38338e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:28<00:00, 17.66it/s]
{'dev_F1': 61.04914322664079, 'dev_F1_ign': 58.78601766868731, 'dev_P': 60.57422407570775, 'dev_R': 61.531568228105904}
Current Step: 9931,  Current LM lr: 1.80863e-05, Current Classifier lr: 6.02878e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:28<00:00, 17.62it/s]
{'dev_F1': 60.84635001593879, 'dev_F1_ign': 58.58215943139871, 'dev_P': 59.550737071991264, 'dev_R': 62.19959266802444}
Current Step: 10695,  Current LM lr: 1.70225e-05, Current Classifier lr: 5.67417e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 17.98it/s]
{'dev_F1': 61.20223128798601, 'dev_F1_ign': 59.13503703875137, 'dev_P': 62.5776794075083, 'dev_R': 59.88594704684318}
Current Step: 11459,  Current LM lr: 1.59587e-05, Current Classifier lr: 5.31956e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 17.94it/s]
{'dev_F1': 61.159751300596376, 'dev_F1_ign': 59.06939376117604, 'dev_P': 63.59957776213933, 'dev_R': 58.90020366598778}
Current Step: 12223,  Current LM lr: 1.48949e-05, Current Classifier lr: 4.96496e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.14it/s]
{'dev_F1': 61.24746492280949, 'dev_F1_ign': 59.21938061708555, 'dev_P': 62.24970553592462, 'dev_R': 60.27698574338085}
Current Step: 12987,  Current LM lr: 1.38311e-05, Current Classifier lr: 4.61035e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.13it/s]
{'dev_F1': 61.6572096128171, 'dev_F1_ign': 59.64227939141086, 'dev_P': 63.191653125801764, 'dev_R': 60.195519348268846}
Current Step: 13751,  Current LM lr: 1.27672e-05, Current Classifier lr: 4.25574e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 17.88it/s]
{'dev_F1': 61.01345154387037, 'dev_F1_ign': 58.578242083293496, 'dev_P': 57.4605916648672, 'dev_R': 65.0346232179226}
Current Step: 14515,  Current LM lr: 1.17034e-05, Current Classifier lr: 3.90114e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 17.97it/s]
{'dev_F1': 61.7608624632473, 'dev_F1_ign': 59.637076970603275, 'dev_P': 61.917628756243346, 'dev_R': 61.604887983706725}
Current Step: 15279,  Current LM lr: 1.06396e-05, Current Classifier lr: 3.54653e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:28<00:00, 17.76it/s]
{'dev_F1': 62.289670718943725, 'dev_F1_ign': 60.14308115508973, 'dev_P': 61.56600620673191, 'dev_R': 63.03054989816701}
Current Step: 16043,  Current LM lr: 9.57577e-06, Current Classifier lr: 3.19192e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.44it/s]
{'dev_F1': 62.06021927671412, 'dev_F1_ign': 59.96556012205419, 'dev_P': 62.330511956611055, 'dev_R': 61.79226069246436}
Current Step: 16807,  Current LM lr: 8.51195e-06, Current Classifier lr: 2.83732e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.37it/s]
{'dev_F1': 62.15828552143099, 'dev_F1_ign': 60.16217847044481, 'dev_P': 64.45883279377024, 'dev_R': 60.016293279022406}
Current Step: 17571,  Current LM lr: 7.44813e-06, Current Classifier lr: 2.48271e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.00it/s]
{'dev_F1': 62.437165558618446, 'dev_F1_ign': 60.317359912264045, 'dev_P': 62.139917695473244, 'dev_R': 62.73727087576375}
Current Step: 18335,  Current LM lr: 6.38431e-06, Current Classifier lr: 2.12810e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 17.96it/s]
{'dev_F1': 62.76586871298691, 'dev_F1_ign': 60.77660542323755, 'dev_P': 64.29975220029053, 'dev_R': 61.30346232179226}
Current Step: 19099,  Current LM lr: 5.32049e-06, Current Classifier lr: 1.77350e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.00it/s]
{'dev_F1': 62.616166205443804, 'dev_F1_ign': 60.56067754447577, 'dev_P': 63.5053619302949, 'dev_R': 61.75152749490835}
Current Step: 19863,  Current LM lr: 4.25667e-06, Current Classifier lr: 1.41889e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.15it/s]
{'dev_F1': 62.847831536726, 'dev_F1_ign': 60.87927514169921, 'dev_P': 64.50810532635732, 'dev_R': 61.270875763747455}
Current Step: 20627,  Current LM lr: 3.19285e-06, Current Classifier lr: 1.06428e-05
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:27<00:00, 18.46it/s]
{'dev_F1': 62.84529240978848, 'dev_F1_ign': 60.84056854720389, 'dev_P': 64.0135192226447, 'dev_R': 61.71894093686354}
Current Step: 21391,  Current LM lr: 2.12903e-06, Current Classifier lr: 7.09677e-06
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:28<00:00, 17.39it/s]
{'dev_F1': 63.014727356168386, 'dev_F1_ign': 61.0473866678369, 'dev_P': 64.58012656062938, 'dev_R': 61.52342158859471}
Current Step: 22155,  Current LM lr: 1.06521e-06, Current Classifier lr: 3.55071e-06
evaluate: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 499/499 [00:30<00:00, 16.49it/s]
{'dev_F1': 63.05353051447615, 'dev_F1_ign': 61.06052348874125, 'dev_P': 64.51832907075874, 'dev_R': 61.65376782077393}
Current Step: 22919,  Current LM lr: 1.39243e-09, Current Classifier lr: 4.64145e-09
